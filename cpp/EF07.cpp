//#pragma section _EF07
#pragma section _main

#include <umachine.h>

#include "misc.h"
#include "constbyte.h"
#include "constword.h"
#include "ram.h"
#include "EnVars.h"
#include "hwreg.h"
#include "hardware.h"



//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

static void EF07_sub_1F468();
static void EF07_sub_1F4FC();
static void EF07_sub_1F53A();
static void EF07_sub_1F6C4();
static void EF07_sub_1F86C();
static void EF07_sub_1F882();
static void EF07_sub_1F9B4();
static u16 EF07_sub_1FA16();
static u16 EF07_sub_1FA22();
static u16 EF07_sub_1FA9C();
static u16 EF07_sub_1FAD2();
static void EF07_sub_1FB14();
static void EF07_sub_1FBE4();
static void EF07_sub_1FC2C();
static u16 EF07_sub_1FC5E();
static u16 EF07_sub_1FC6A();
static void EF07_sub_1FC76();
static u16 EF07_sub_1FDD6();
static void EF07_sub_1FDF2();
static void EF07_sub_1FE22();
static u16 EF07_sub_1FE5C();
static u16 EF07_sub_1FE8A();
static void EF07_sub_1FE96();
static u16 EF07_sub_1FECC();
static u16 EF07_sub_1FED8();
static u16 EF07_sub_1FEE4();
static u16 EF07_sub_1FEF0();
static u16 EF07_sub_1FF2A();
static void EF07_sub_1FF36();
static void EF07_sub_1FF94();
static void Init_Clear_active_faults();
static void EF07_sub_20308();
static void EF07_sub_204AC();

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

extern "C" void SysInit_NVRAM_1F3E0()
{
	Init_Clear_active_faults();

	CLR(word_FFFF80E6, 0x8000);
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

extern "C" void SysInit_sub_1F408()
{
	word_FFFF8718 = t1_unk_253E/*20*/;

	FLAGS_FFFF8EB0 = 0x41;

	SET(wMUT9A_Ligths_Bit_Array, 8);
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


extern "C" void EF07_root_sub_1F428()
{
	EF07_sub_1F468();
	EF07_sub_1F4FC();
	EF07_sub_1F53A();
	EF07_sub_1F6C4();
	EF07_sub_1F86C();
	EF07_sub_1FF94();
	EF07_sub_20308();
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

static void EF07_sub_1F468()
{
	if (timer_up_FFFF852C < 4)
	{
		CLR(word_FFFF80E6, 0x6A);
		CLR(word_FFFF80E8, 0x2A);
		SET(word_FFFF80E6, 1);
		word_FFFF8DE8 = 0;
		word_FFFF8718 = t1_unk_253E/*20*/;
		word_FFFF854E = 0;

		u32 r1 = SwapBytes16(0);

		wMUT40_Stored_Faults_Lo = SwapBytes16(wMUT40_Stored_Faults_Lo & 0x11);
		wMUT41_Stored_Faults_Hi = r1;

		wMUT42_Stored_Faults_Lo_1 = SwapBytes16(wMUT42_Stored_Faults_Lo_1 & 0x82);
		wMUT43_Stored_Faults_Hi_1 = r1;
		wMUT44_Stored_Faults_Lo_2 = r1;
		Stored_Faults_Hi_2 = r1;

		CLR(wMUT71_Sensor_Error, MUT71_4_bit);
	};
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1F4FC()
{
	if (timer_FFFF8592 == 0)
	{
		SET(word_FFFF80E6, 1);
	}
	else if ((word_FFFF80E6 & 1) || (wMUT1E_MAF_RESET_FLAG & CRANKING))
	{
		CLR(word_FFFF80E6, 1);
		word_FFFF854E = 0;
	};
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1F53A()
{
    if (timer_up_FFFF852C <= 32)
    {
		if (ZRO(wMUT1E_MAF_RESET_FLAG, STALL) || wMUT07_CoolTemp_ADC8bit >= 5 || wMUT14_Battery_Level_ADC8bit < (18.03918/0.07333))
		{
			// loc_1F568

			CLR(FLAGS_FFFF8EB0, 0x40);
		};
	}
	else
	{
		if (FLAGS_FFFF8EB0 & 1)
		{
			if (wMUT2F_Vehicle_Speed < 180/2)
			{
				CLR(FLAGS_FFFF8EB0, 0x40);
			};

			if (FLAGS_FFFF8EB0 & 0x40)
			{
				SET(FLAGS_FFFF8EB0, 0x80);
			};
		};

		// loc_1F5A2

		CLR(FLAGS_FFFF8EB0, 0x41);

		if (wMUT14_Battery_Level_ADC8bit < 177/*12.98/0.07333*/)
		{
			CLR(FLAGS_FFFF8EB0, 0x80);
		};
	};

	// loc_1F5C0

	if ((FLAGS_FFFF8EB0 & 0x80) && ZRO(FLAGS_FFFF8EB0, 2))
	{
		u32 r1 = ChkSum(0, 0x8000);

		r1 += ChkSum((void*)0x8000, 0x8000);
		r1 += ChkSum((void*)0x10000, 0x8000);
		r1 += ChkSum((void*)0x18000, 0x8000);
		r1 += ChkSum((void*)0x20000, 0x8000);
		r1 += ChkSum((void*)0x28000, 0x8000);
		r1 += ChkSum((void*)0x30000, 0x8000);
		r1 += ChkSum((void*)0x38000, 0x8000);

		bMUTFD_MUT_RES1_FFFF8EB2 = r1;

		SET(FLAGS_FFFF8EB0, 2);
	};
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1F6C4()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1F86C()
{
	EF07_sub_1F882();
	EF07_sub_1FF36();
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1F882()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1F9B4()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FA16()
{
	return 2;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FA22()
{
	u32 r13;

	if (ZRO(wMUT71_Sensor_Error, MUT71_3_MAP))
	{
		r13 = 1;
	}
	else 
	{
		r13 = 0;

		if ((wMUT71_Sensor_Error & MUT71_3_MAP) && (wMUT1A_Manifold_AbsPressure_ADC8bit >= word_1C66))
		{

		};
	};

	return r13;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FA9C()
{
	u32 r13 = 2;

	if (timer_FFFF8592 != 0)
	{
		r13 = 1;
	}
	else if (RT_FLAG1_FFFF8888 & STARTER)
	{
		if (ZRO(wMUTD1_BitMap_FAA, FAA_3_IMMO) || (word_FFFF80FA & 0x80))
		{
			r13 = 0;
		};
	};

	return r13;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FAD2()
{
	u32 r1 = 2;

	if (timer_FFFF8592 != 0)
	{
		if (word_FFFF8DE6 == 0)
		{
			r1 = 0;
		}
		else if (camShaftFlags & 1)
		{
			r1 = 1;
		}
		else if (!Check_Starter_signal())
		{
			r1 = 0;
		};
	};

	return r1;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1FB14()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1FBE4()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1FC2C()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FC5E()
{
	return 1;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FC6A()
{
	return 1;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1FC76()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FDD6()
{
	u32 r13 = 1;

	if (wMUT71_Sensor_Error & MUT71_5_ALTERNATOR)
	{
		word_FFFF8718 = r13 = 0;
	};

	return r13;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1FDF2()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1FE22()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FE5C()
{
	u32 r13 = 2;

	if (wMUT71_Sensor_Error & MUT71_11_bit)
	{
		r13 = 1;
	}
	else if (wMUT71_Sensor_Error & MUT71_9_bit)
	{
		word_FFFF8718 = r13 = 0;
	};

	return r13;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FE8A()
{
	return 1;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1FE96()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FECC()
{
	return 1;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FED8()
{
	return 1;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FEE4()
{
	return 1;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FEF0()
{
	return 0;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static u16 EF07_sub_1FF2A()
{
	return 1;
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1FF36()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_1FF94()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void Init_Clear_active_faults()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 
static void EF07_sub_20308()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
static void EF07_sub_204AC()
{

}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
           
